Redoing dataset
Preparing dataset
/home/johannbs/anaconda3/lib/python3.8/site-packages/sklearn/utils/deprecation.py:143: FutureWarning: The sklearn.preprocessing.data module is  deprecated in version 0.22 and will be removed in version 0.24. The corresponding classes / functions should instead be imported from sklearn.preprocessing. Anything that cannot be imported from sklearn.preprocessing is now part of the private API.
  warnings.warn(message, FutureWarning)
/home/johannbs/anaconda3/lib/python3.8/site-packages/sklearn/base.py:329: UserWarning: Trying to unpickle estimator RobustScaler from version 0.19.1 when using version 0.23.2. This might lead to breaking code or invalid results. Use at your own risk.
  warnings.warn(
Connected to /home/johannbs/Desktop/IceCube_GNN/data/db_files/rasmus_classification_muon_3neutrino_3mio.db
Extracting features for train
  0%|                                                                                                      | 0/45 [00:00<?, ?it/s]  2%|██                                                                                            | 1/45 [00:01<00:46,  1.05s/it]  4%|████▏                                                                                         | 2/45 [01:22<18:00, 25.13s/it]  7%|██████▎                                                                                       | 3/45 [03:18<36:41, 52.41s/it]  9%|████████▎                                                                                     | 4/45 [04:29<39:34, 57.91s/it] 11%|██████████▍                                                                                   | 5/45 [05:33<39:52, 59.80s/it] 13%|████████████▌                                                                                 | 6/45 [06:18<35:55, 55.26s/it] 16%|██████████████▌                                                                               | 7/45 [07:02<33:02, 52.16s/it] 18%|████████████████▋                                                                             | 8/45 [07:57<32:35, 52.86s/it] 20%|██████████████████▊                                                                           | 9/45 [08:50<31:50, 53.06s/it] 22%|████████████████████▋                                                                        | 10/45 [09:32<28:57, 49.66s/it] 24%|██████████████████████▋                                                                      | 11/45 [10:15<27:01, 47.70s/it] 27%|████████████████████████▊                                                                    | 12/45 [10:59<25:36, 46.57s/it] 29%|██████████████████████████▊                                                                  | 13/45 [11:33<22:48, 42.76s/it] 31%|████████████████████████████▉                                                                | 14/45 [12:13<21:38, 41.88s/it] 33%|███████████████████████████████                                                              | 15/45 [12:48<19:58, 39.94s/it] 36%|█████████████████████████████████                                                            | 16/45 [13:22<18:26, 38.15s/it] 38%|███████████████████████████████████▏                                                         | 17/45 [13:51<16:28, 35.30s/it] 40%|█████████████████████████████████████▏                                                       | 18/45 [14:28<16:05, 35.76s/it] 42%|███████████████████████████████████████▎                                                     | 19/45 [14:53<14:07, 32.61s/it] 44%|█████████████████████████████████████████▎                                                   | 20/45 [15:16<12:21, 29.67s/it] 47%|███████████████████████████████████████████▍                                                 | 21/45 [15:41<11:21, 28.41s/it] 49%|█████████████████████████████████████████████▍                                               | 22/45 [16:06<10:26, 27.25s/it] 51%|███████████████████████████████████████████████▌                                             | 23/45 [16:29<09:29, 25.86s/it] 53%|█████████████████████████████████████████████████▌                                           | 24/45 [16:48<08:24, 24.04s/it] 56%|███████████████████████████████████████████████████▋                                         | 25/45 [17:07<07:31, 22.57s/it] 58%|█████████████████████████████████████████████████████▋                                       | 26/45 [17:27<06:50, 21.61s/it] 60%|███████████████████████████████████████████████████████▊                                     | 27/45 [17:45<06:11, 20.65s/it] 62%|█████████████████████████████████████████████████████████▊                                   | 28/45 [18:00<05:19, 18.79s/it] 64%|███████████████████████████████████████████████████████████▉                                 | 29/45 [18:14<04:40, 17.51s/it] 67%|██████████████████████████████████████████████████████████████                               | 30/45 [18:26<03:58, 15.90s/it] 69%|████████████████████████████████████████████████████████████████                             | 31/45 [18:40<03:31, 15.10s/it] 71%|██████████████████████████████████████████████████████████████████▏                          | 32/45 [18:50<02:59, 13.78s/it] 73%|████████████████████████████████████████████████████████████████████▏                        | 33/45 [19:00<02:30, 12.52s/it] 76%|██████████████████████████████████████████████████████████████████████▎                      | 34/45 [19:09<02:08, 11.64s/it] 78%|████████████████████████████████████████████████████████████████████████▎                    | 35/45 [19:20<01:51, 11.18s/it] 80%|██████████████████████████████████████████████████████████████████████████▍                  | 36/45 [19:30<01:38, 10.91s/it] 82%|████████████████████████████████████████████████████████████████████████████▍                | 37/45 [19:39<01:22, 10.34s/it] 84%|██████████████████████████████████████████████████████████████████████████████▌              | 38/45 [19:47<01:08,  9.82s/it] 87%|████████████████████████████████████████████████████████████████████████████████▌            | 39/45 [19:58<01:01, 10.17s/it] 89%|██████████████████████████████████████████████████████████████████████████████████▋          | 40/45 [20:07<00:48,  9.76s/it] 91%|████████████████████████████████████████████████████████████████████████████████████▋        | 41/45 [20:14<00:35,  8.90s/it] 93%|██████████████████████████████████████████████████████████████████████████████████████▊      | 42/45 [20:21<00:24,  8.23s/it] 96%|████████████████████████████████████████████████████████████████████████████████████████▊    | 43/45 [20:28<00:15,  7.95s/it] 98%|██████████████████████████████████████████████████████████████████████████████████████████▉  | 44/45 [20:34<00:07,  7.29s/it]100%|█████████████████████████████████████████████████████████████████████████████████████████████| 45/45 [20:40<00:00,  7.05s/it]100%|█████████████████████████████████████████████████████████████████████████████████████████████| 45/45 [20:40<00:00, 27.57s/it]
Extracting features for val
  0%|                                                                                                       | 0/3 [00:00<?, ?it/s] 33%|███████████████████████████████▋                                                               | 1/3 [00:05<00:10,  5.02s/it] 67%|███████████████████████████████████████████████████████████████▎                               | 2/3 [00:10<00:05,  5.10s/it]100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:12<00:00,  4.25s/it]100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:12<00:00,  4.19s/it]
Extracting features for test
  0%|                                                                                                       | 0/3 [00:00<?, ?it/s] 33%|███████████████████████████████▋                                                               | 1/3 [00:03<00:07,  3.73s/it] 67%|███████████████████████████████████████████████████████████████▎                               | 2/3 [00:07<00:03,  3.66s/it]100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:08<00:00,  3.01s/it]100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:08<00:00,  2.91s/it]
Making adjacency matrices
  0%|                                                                                                      | 0/51 [00:00<?, ?it/s]  2%|█▊                                                                                            | 1/51 [00:07<05:50,  7.02s/it]  4%|███▋                                                                                          | 2/51 [00:23<08:04,  9.88s/it]  6%|█████▌                                                                                        | 3/51 [00:38<09:00, 11.25s/it]  8%|███████▎                                                                                      | 4/51 [00:52<09:39, 12.33s/it] 10%|█████████▏                                                                                    | 5/51 [01:07<09:52, 12.89s/it] 12%|███████████                                                                                   | 6/51 [01:21<10:07, 13.49s/it] 14%|████████████▉                                                                                 | 7/51 [01:36<10:02, 13.70s/it] 16%|██████████████▋                                                                               | 8/51 [01:50<09:52, 13.77s/it] 18%|████████████████▌                                                                             | 9/51 [02:04<09:45, 13.94s/it] 20%|██████████████████▏                                                                          | 10/51 [02:18<09:32, 13.97s/it] 22%|████████████████████                                                                         | 11/51 [02:32<09:20, 14.00s/it] 24%|█████████████████████▉                                                                       | 12/51 [02:47<09:11, 14.14s/it] 25%|███████████████████████▋                                                                     | 13/51 [03:01<09:00, 14.21s/it] 27%|█████████████████████████▌                                                                   | 14/51 [03:15<08:42, 14.13s/it] 29%|███████████████████████████▎                                                                 | 15/51 [03:29<08:25, 14.04s/it] 31%|█████████████████████████████▏                                                               | 16/51 [03:43<08:12, 14.07s/it] 33%|███████████████████████████████                                                              | 17/51 [03:57<07:57, 14.06s/it] 35%|████████████████████████████████▊                                                            | 18/51 [04:11<07:44, 14.09s/it] 37%|██████████████████████████████████▋                                                          | 19/51 [04:25<07:32, 14.13s/it] 39%|████████████████████████████████████▍                                                        | 20/51 [04:40<07:21, 14.23s/it] 41%|██████████████████████████████████████▎                                                      | 21/51 [04:54<07:03, 14.12s/it] 43%|████████████████████████████████████████                                                     | 22/51 [05:08<06:49, 14.12s/it] 45%|█████████████████████████████████████████▉                                                   | 23/51 [05:22<06:35, 14.13s/it] 47%|███████████████████████████████████████████▊                                                 | 24/51 [05:36<06:19, 14.05s/it] 49%|█████████████████████████████████████████████▌                                               | 25/51 [05:50<06:04, 14.02s/it] 51%|███████████████████████████████████████████████▍                                             | 26/51 [06:04<05:53, 14.14s/it] 53%|█████████████████████████████████████████████████▏                                           | 27/51 [06:12<04:57, 12.41s/it] 55%|███████████████████████████████████████████████████                                          | 28/51 [06:27<04:59, 13.03s/it] 57%|████████████████████████████████████████████████████▉                                        | 29/51 [06:41<04:53, 13.36s/it] 59%|██████████████████████████████████████████████████████▋                                      | 30/51 [06:56<04:50, 13.84s/it] 61%|████████████████████████████████████████████████████████▌                                    | 31/51 [07:11<04:42, 14.11s/it] 63%|██████████████████████████████████████████████████████████▎                                  | 32/51 [07:25<04:27, 14.05s/it] 65%|████████████████████████████████████████████████████████████▏                                | 33/51 [07:39<04:13, 14.08s/it] 67%|██████████████████████████████████████████████████████████████                               | 34/51 [07:53<03:58, 14.05s/it] 69%|███████████████████████████████████████████████████████████████▊                             | 35/51 [08:07<03:47, 14.24s/it] 71%|█████████████████████████████████████████████████████████████████▋                           | 36/51 [08:21<03:28, 13.90s/it] 73%|███████████████████████████████████████████████████████████████████▍                         | 37/51 [08:34<03:14, 13.90s/it] 75%|█████████████████████████████████████████████████████████████████████▎                       | 38/51 [08:49<03:03, 14.14s/it] 76%|███████████████████████████████████████████████████████████████████████                      | 39/51 [09:03<02:49, 14.16s/it] 78%|████████████████████████████████████████████████████████████████████████▉                    | 40/51 [09:18<02:36, 14.20s/it] 80%|██████████████████████████████████████████████████████████████████████████▊                  | 41/51 [09:33<02:24, 14.48s/it] 82%|████████████████████████████████████████████████████████████████████████████▌                | 42/51 [09:46<02:06, 14.10s/it] 84%|██████████████████████████████████████████████████████████████████████████████▍              | 43/51 [09:59<01:50, 13.76s/it] 86%|████████████████████████████████████████████████████████████████████████████████▏            | 44/51 [10:13<01:36, 13.71s/it] 88%|██████████████████████████████████████████████████████████████████████████████████           | 45/51 [10:27<01:23, 13.86s/it] 90%|███████████████████████████████████████████████████████████████████████████████████▉         | 46/51 [10:41<01:09, 13.93s/it] 92%|█████████████████████████████████████████████████████████████████████████████████████▋       | 47/51 [10:54<00:55, 13.76s/it] 94%|███████████████████████████████████████████████████████████████████████████████████████▌     | 48/51 [11:08<00:41, 13.70s/it] 96%|█████████████████████████████████████████████████████████████████████████████████████████▎   | 49/51 [11:21<00:27, 13.65s/it] 98%|███████████████████████████████████████████████████████████████████████████████████████████▏ | 50/51 [11:36<00:13, 13.98s/it]100%|█████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [11:50<00:00, 14.03s/it]100%|█████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [11:50<00:00, 13.94s/it]
[0;31m---------------------------------------------------------------------------[0m
[0;31mUnboundLocalError[0m                         Traceback (most recent call last)
[0;32m~/Desktop/IceCube_GNN2/run_trainings.py[0m in [0;36m<module>[0;34m[0m
[1;32m     28[0m     [0;31m# Try to train the model given the construction dict[0m[0;34m[0m[0;34m[0m[0;34m[0m[0m
[1;32m     29[0m     [0;31m# try:[0m[0;34m[0m[0;34m[0m[0;34m[0m[0m
[0;32m---> 30[0;31m     [0mtrain_model[0m[0;34m([0m[0mconstruct_dict[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m     31[0m     [0mshutil[0m[0;34m.[0m[0mmove[0m[0;34m([0m[0mosp[0m[0;34m.[0m[0mjoin[0m[0;34m([0m[0mexp_folder[0m[0;34m,[0m [0;34m"done"[0m[0;34m,[0m [0mexperiment[0m[0;34m)[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[1;32m     32[0m     [0mprint[0m[0;34m([0m[0;34mf"Experiment {experiment[:-5]} done \t {experiment}: {i} / {len(exp_list)}"[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m

[0;32m~/Desktop/IceCube_GNN2/scripts/train_script.py[0m in [0;36mtrain_model[0;34m(construct_dict)[0m
[1;32m    124[0m     [0mearly_stop[0m            [0;34m=[0m [0;32mFalse[0m[0;34m[0m[0;34m[0m[0m
[1;32m    125[0m     [0mbatch_time[0m            [0;34m=[0m [0mnp[0m[0;34m.[0m[0mones[0m[0;34m([0m[0;36m10[0m[0;34m)[0m [0;34m*[0m [0;36m100[0m[0;34m[0m[0;34m[0m[0m
[0;32m--> 126[0;31m     [0mtime[0m                  [0;34m=[0m [0mtime[0m[0;34m.[0m[0mtime[0m[0;34m([0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m    127[0m [0;34m[0m[0m
[1;32m    128[0m     [0;31m# Start loop[0m[0;34m[0m[0;34m[0m[0;34m[0m[0m

[0;31mUnboundLocalError[0m: local variable 'time' referenced before assignment

[23;0t